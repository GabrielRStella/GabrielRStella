var MS_PER_TICK = 10;

var PREV_TICK_MS = new Date().getTime();

var GAME_PAUSED = true;
var KEY_PAUSE = new Key(KEY_P, function() { GAME_PAUSED = !GAME_PAUSED; });
addKeyListenerDown(KEY_PAUSE);

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//window
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var CANVAS_ELEMENT = document.getElementById("gameCanvas");
var CANVAS = CANVAS_ELEMENT.getContext("2d");
var CANVAS_INSET = 5;
var EDGE_PADDING = 10;

var WIDTH = 0;
var HEIGHT = 0;

function RESET_CANVAS() {
  var oldWidth = WIDTH;
  var oldHeight = HEIGHT;

  CANVAS_ELEMENT.width = window.innerWidth - CANVAS_INSET * 2;
  CANVAS_ELEMENT.height = window.innerHeight - CANVAS_INSET * 2;

  WIDTH = CANVAS_ELEMENT.width - EDGE_PADDING * 2;
  HEIGHT = CANVAS_ELEMENT.height - EDGE_PADDING * 2;

  //rescale and transform and such?

  var wMod = WIDTH / oldWidth;
  var hMod = HEIGHT / oldHeight;
}

function RESET_GAME() {
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//logic
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//this is called from draw() to be continuous
function updateTick(part, paused) {
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//drawing
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var prevWindowWidth = window.innerWidth;
var prevWindowHeight = window.innerHeight;

function UPDATE() {

  var ms = new Date().getTime();
  var part = (ms - PREV_TICK_MS) / MS_PER_TICK;

  //resize
  if(prevWindowWidth != window.innerWidth || prevWindowHeight != window.innerHeight) {
    prevWindowWidth = window.innerWidth;
    prevWindowHeight = window.innerHeight;
    RESET_CANVAS();
  }

  if(!GAME_PAUSED) {
    updateTick(part, GAME_PAUSED);
  }

  ///////////////////////////////////////////////////////////////////////////////////////////////////////////
  //---
  ///////////////////////////////////////////////////////////////////////////////////////////////////////////

  CANVAS.setTransform(1, 0, 0, 1, 0, 0);
  CANVAS.clearRect(0, 0, CANVAS_ELEMENT.width, CANVAS_ELEMENT.height);
  CANVAS.translate(EDGE_PADDING, EDGE_PADDING);
  CANVAS.drawImage(getImage("box"), 0, 0, WIDTH, HEIGHT);

  if(GAME_PAUSED) {
  CANVAS.drawImage(getImage("box"), 0, 0, WIDTH / 2, HEIGHT / 2);
  }

  PREV_TICK_MS = ms;

  requestAnimationFrame(UPDATE);
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//start game
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

RESET_CANVAS();
RESET_GAME();
GAME_PAUSED = true;
UPDATE();